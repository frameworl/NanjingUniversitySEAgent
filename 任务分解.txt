南大软件学院 SE 流程智能体 — 任务分解与里程碑
版本：v1.0
日期：2025-11-10

概述：以下为完成大作业所需的主要步骤与子任务，覆盖数据、RAG、工具集成、DSL编排、平台发布与交付材料。每步包含关键产出与检查点，便于执行与验收。

一、环境与账号准备
- 安装与配置：Git、Python/Node.js、向量库（Qdrant/Milvus）、Elasticsearch、OCR工具
- 云平台账号：阿里云百炼、华为平台（ModelArts/盘古服务），开通所需资源与权限
- 密钥管理：SSH/Git凭证、平台API Key，配置本地与CI环境变量
检查点：本地开发环境可运行；云平台控制台可创建应用与访问模型服务

二、数据采集与清洗
- 数据源整理：收集流程文档（PDF、Word、Markdown、网页、图片）与模板
- OCR与结构抽取：对PDF/图片进行OCR；抽取标题/目录/段落层级
- 元数据生成：source、semester、course、type、version、published_at、权限范围
- 清洗与标准化：去噪、统一术语与格式、保留章节路径
产出：标准化原文档集、元数据CSV/JSON、采集脚本
检查点：样例文档能正确解析成结构块并带元数据

三、分块策略与索引管道
- 分块：结构化分块（按H1-H3、列表、表格）+ 滑窗重叠（512-1024 tokens，overlap 256-512）
- 向量索引：生成dense嵌入并写入Qdrant（含payload与层级信息）
- 词法索引：写入Elasticsearch（BM25），配置字段权重
- 层次关系：建立chunk与父章节/文档映射，支持回溯与可解释性
产出：索引构建脚本与配置，索引健康报告
检查点：索引可查询、返回片段附带元数据与章节路径

四、检索融合与候选生成
- 并行召回：BM25@TopK 与 Dense@TopK 并行执行
- 分数融合：归一化+权重（dense≈0.6，sparse≈0.4）
- 过滤：基于元数据的学期/课程/流程类型/版本过滤与权限约束
- 去重与MMR：避免重复片段与冗余信息
产出：检索融合模块与参数配置
检查点：典型查询Top-3命中率达到预期（≥85%基准）

五、重排与答案组装
- 交叉编码器重排：bge-reranker-v2-m3（或平台可用重排）对TopN候选排序
- 上下文拼接：保留引用与章节路径，控制上下文长度
- 结果可解释：返回引用源、版本、置信度，支持展开上下文
产出：重排与组装模块，答案格式定义
检查点：答案稳定且带可用引用；TopN可解释性通过评审

六、会话管理与长期记忆
- 短期记忆：窗口与摘要（最近消息20条，语义摘要）
- 长期记忆：主题分桶（课程/流程）、时间衰减、个性化偏好（角色/课程）
- 读写策略：查询时参与过滤与重排；对话结束更新长期记忆
产出：记忆库实现与策略配置
检查点：个性化检索有效；记忆读写正确并可观测

七、工具插件与MCP集成
- 模板中心：检索后提供模板下载/链接
- 清单生成：把答案转为Checklist（CSV/Markdown导出）
- 日程与消息：创建截止日期日程、推送到企业协作平台机器人
- 文档校验：对提交物进行结构/引用/格式检查并给出建议
- 平台适配：飞书/钉钉/企业微信、Git/Jira 接入（通过MCP统一适配）
产出：工具适配器与权限配置、MCP接入文档
检查点：工具链可单独与联合触发；失败有降级与重试

八、DSL编排与工作流
- DSL定义：数据源、索引、检索、重排、过滤、工具、记忆、发布
- 执行器：加载DSL并执行端到端流程；支持可视化与一键运行
- 版本管理：DSL版本化与灰度发布、回滚策略
产出：se_agent.dsl.yaml 与编排执行器
检查点：DSL执行成功；参数可调；流程图可导出截图

九、API与外部调用集成
- REST接口：/v1/ask、/v1/checklist、/v1/calendar/create、/v1/docs/source
- 鉴权：API Key/Token、角色权限与可见范围
- SDK/示例：Python/Node调用示例与错误处理
产出：API服务与示例代码，使用说明
检查点：外部软件可成功调用并获得引用与动作结果

十、发布到阿里云百炼
- 创建应用：配置模型、RAG资源（向量/ES）、环境变量与密钥
- 绑定工具：MCP适配器/HTTP插件；设置配额与限流
- 发布审核：填写应用信息（名称、描述、类目、可见范围），提交审核并上线
产出：应用发布页与入口URL，配置截图
检查点：在线访问正常；性能与配额达标；日志与监控开启

十一、发布到华为平台
- 创建服务：配置推理模型与RAG检索资源，导入DSL流程到工作流/管道
- 安全与监控：鉴权、审计、观测面板、弹性伸缩
- 发布与外部访问：提供入口与API说明，记录版本
产出：应用发布页与入口URL，配置截图
检查点：在线访问正常；工具链可用；性能指标达标

十二、评测与优化
- 离线评测：流程FAQ数据集；A/B测试嵌入与重排策略
- 线上观测：Top-k命中率、响应时间、工具成功率、引用覆盖率
- 调优：分块参数、TopK、融合权重、MMR、过滤策略
产出：评测报告与优化记录
检查点：指标达到或优于目标；变化有变更说明

十三、文档与交付材料
- 用户需求文档：已生成（用户需求文档.txt）
- 技术实现文档：已生成（技术实现文档.txt）
- 流程截图：UI与平台发布页截图（补充）
- DSL文件：se_agent.dsl.yaml（补充）
- RAG选型与实现细节：技术文档与参数表
- 应用发布信息：平台、入口URL、版本、可见范围、鉴权说明
- API示例与集成说明：代码与README
检查点：所有交付物完整、格式统一、可复现

十四、运维与安全
- 密钥与权限：平台密钥管理、最小权限原则、定期轮换
- 日志与审计：访问日志、操作审计、异常告警
- 灰度与回滚：索引与DSL版本化；发布回滚流程
产出：运维手册与安全策略说明
检查点：演练通过；异常路径清晰可操作

十五、风险与应对
- 文档质量不一：制定采集与清洗规范，必要时补充人工标注
- 平台限流与配额：实现本地降级与缓存；监控配额使用
- 模型与索引升级：版本兼容策略与回滚计划
- 权限与合规变更：元数据权限过滤与审计增强
产出：风险台账与应对预案
检查点：定期复盘；关键风险有缓解措施

附：里程碑时间建议
- W1：数据采集与索引PoC；DSL骨架
- W2：混合检索与重排；工具与记忆PoC
- W3：评测优化；发布到阿里云百炼
- W4：发布到华为平台；API集成示例；交付材料归档